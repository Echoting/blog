# 字符编码

### 关于䶮字的编码
![](http://pik.internal.baidu.com/2019/04/01/dc079789167949f31157f8eadf45aadb.png)

![](http://pik.internal.baidu.com/2019/04/01/6a97709a8c06581ebd4b1e3a40e650a4.png)

上图说明Unicode对这两个字都有对应的编码；

而GBK没有收录䶮（u4dae），所以在GBK编码的文件中，这个字会乱码；   
GB18030则两个都支持；


（59491/ue864）：本系统使用的，所以Windows都能显示这个字

䶮（19886/u4dae）：

## 一、前期知识准备
### 1. 字符集
    什么是字符集？顾名思义，字符集就是字符的集合（这里的集合是数学意义上的集合）。                
    比如汉字字符集，英文字符集等。

    Unicode也是一种字符集，它包含了所有字符。
### 2. 字符编码
    字符编码是一套规则。是在字符与01比特串之间建立对应关系的一种规则。

    U系列：UCS-2，UCS-4，UTF-8，UTF-16，UTF-32
    
    中文系列：GB2312，GBK，gb18030，Big5
    
    其他：ASCII，Latin-1，Shift_JIS，EUC-KR
### 3. 特殊名词
    ANSI不是一种编码方式。
    这是windows中使用的一个词，可以认为是一个地区的默认编码。
    在简体中文Windows操作系统中，ANSI 编码代表 GBK 编码；
    在繁体中文Windows操作系统中，ANSI编码代表Big5编码；
    在日文Windows操作系统中，ANSI 编码代表 Shift_JIS 编码；
    在韩文Windows操作系统中，ANSI编码代表EUC-KR编码值。

## 二、Unicode（UniversalMultiple-Octet Coded Character Set）

> Unicode（统一码、万国码、单一码）是计算机科学领域里的一项业界标准,包括字符集、编码方案等。Unicode 是为了解决传统的字符编码方案的局限而产生的，它为每种语言中的每个字符设定了统一并且唯一的二进制编码，以满足跨语言、跨平台进行文本转换、处理的要求。1990年开始研发，1994年正式公布。

Unicode的文件头有两种：

大端模式为 0xFE 0xFF

小端模式为 0xFF 0xFE

**举个栗子**  
严（4E25）
大端模式：4E 25
小端模式：25 4E

**计算机如何分辨文件是采用哪种方式编码的呢？**  
Unicode 规范定义，每一个文件的最前面分别加入一个表示编码顺序的字符，这个字符的名字叫做"零宽度非换行空格"（zero width no-break space），用FEFF表示。这正好是两个字节，而且FF比FE大1。

如果一个文本文件的头两个字节是FE FF，就表示该文件采用大头方式；如果头两个字节是FF FE，就表示该文件采用小头方式。

## 三、常用编码
### 1. ASCII
> 我们知道，计算机内部，所有信息最终都是一个二进制值。每一个二进制位（bit）有0和1两种状态，因此八个二进制位就可以组合出256种状态，这被称为一个字节（byte）。也就是说，一个字节一共可以用来表示256种不同的状态，每一个状态对应一个符号，就是256个符号，从00000000到11111111。

> 上个世纪60年代，美国制定了一套字符编码，对英语字符与二进制位之间的关系，做了统一规定。这被称为 ASCII 码，一直沿用至今。

> ASCII 码一共规定了128个字符的编码，比如空格SPACE是32（二进制00100000），大写的字母A是65（二进制01000001）。这128个符号（包括32个不能打印出来的控制符号），只占用了一个字节的后面7位，最前面的一位统一规定为0。

### 2. UTF-8
> UTF-8（8-bit Unicode Transformation Format）是一种针对Unicode的可变长度字符编码，又称万国码。UTF-8用1到6个字节编码Unicode字符。用在网页上可以统一页面显示中文简体繁体及其它语言（如英文，日文，韩文）。

- UTF-8是一种非常通用的可变长字符编码方式;
- 可变长编码就是指在针对某个字符进行编码时，他的表示长度是不固定的。像UTF-8里面，ASCII所表示的字符集就是用1 Byte来表示，而大部分汉字则是用3 Byte来表示。

##### 表示方式：
下面介绍Unicode字符转换为UTF-8编码方式的具体步骤。其中的x表示转换成UTF-8编码后，Unicode码占用的二进制位置

Unicode符号范围（十六进制） | UTF-8编码方式（二进制）
---|---
0000 0000-0000 007F | 0xxxxxxx
0000 0080-0000 07FF | 110xxxxx 10xxxxxx
0000 0800-0000 FFFF | 1110xxxx 10xxxxxx 10xxxxxx
0001 0000-0010 FFFF | 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx

当我们得到Unicode码之后，根据上表判断其所在的位置，然后将Unicode码转换为二进制表示，从后往前截取UTF-8编码中所留为之长度，从前往后依次填入对应位置，所即可得到UTF-8的编码。

**举个栗子**  
以阮一峰老师的“严”字举例  
“严”的Unicode是4E25，转换为二进制为（0100 1110 0010 0101）  
根据上表发现，“严”处在第三行的位置，  依次从“严”的最后一个二进制开始，依次从后向前填入格式中的x，多出的补0。这样就得到了“严”的UTF-8编码：
11100100 10111000 10100101，转换为十六进制就是(E4 B8 A5)

### 3.UTF-16
> UTF-16是Unicode字符编码五层次模型的第三层：字符编码表（Character Encoding Form，也称为 "storage format"）的一种实现方式。即把Unicode字符集的抽象码位映射为16位长的整数（即码元， 长度为2 Byte）的序列，用于数据存储或传递。Unicode字符的码位，需要1个或者2个16位长的码元来表示，因此这是一个变长表示。

> 由于UTF-16最少也会用2 Byte来表示一个字符，因此没有办法兼容ASCII编码（ASCII编码使用1 Byte来进行存储）。

##### 表示方法
在UTF-16中，将Unicode分为了两个范围，分别通过不同的方式进行存储； 
![](http://pik.internal.baidu.com/2019/04/02/b6d7ee38ceffd1c4b2dba6d6633fe4f0.png)

文字说明不形象，还是**举个栗子**  
\u12345 这个值在第二部分，因此减去0x10000，得到\u02345（0000 0010 0011 0100 0101）;  
拆分成高10位（0000 0010 00） 低10位（11 0100 0101）；  
高10位加上0xD800，得到（D808）；  
低10位加上0xDC00，得到（DF45）;
因此最后的UTF-16的编码为（D8 08 DF 45）

### 3.GB系列（此处收录的汉字数字可能有误）
GB编码是中国创造的编码方式。包括GB2312、GBK、GB18030等，从字符集范围看，GB2312 < GBK < GB18030。
GB2312：单字节（英文）或双字节（中文）。

GBK：单字节（英文）或双字节（中文）。

GB18030：单字节、双字节和4字节。

双字节２是全角的二，单字节即ASCII的2是半角的二。

高字节的最高位为0则为ASCII，为1则为中文。

GB2312(1980年)一共收录了7445个字符，包括6763个汉字和682个其它符号。汉字区的内码范围高字节从B0-F7，低字节从A1-FE，占用的码位是72*94=6768。其中有5个空位是D7FA-D7FE。

GB2312支持的汉字太少。1995年的汉字扩展规范GBK1.0收录了21886个符号，它分为汉字区和图形符号区。汉字区包括21003个字符。

2000年的GB18030是取代GBK1.0的正式国家标准。该标准收录了27484个汉字，同时还收录了藏文、蒙文、维吾尔文等主要的少数民族文字。从汉字字汇上说，GB18030在GB13000.1的20902个汉字的基础上增加了CJK扩展A的6582个汉字（Unicode码0x3400-0x4db5），一共收录了27484个汉字，与GB 2312-1980完全兼容，与GBK基本兼容；

### 4.Big5
双字节，兼容ASCII。又称为大五码或五大码，是使用繁体中文（正体中文）社区中最常用的电脑汉字字符集标准，共收录13,060个汉字；


